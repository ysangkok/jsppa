<html>
<head>
				<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
				<title>Cleaner tests</title>
				</head>
				<body>
				<table cellpadding="1" cellspacing="1" border="1">
				<thead>
				<tr><td rowspan="1" colspan="3">Clean every created stuff for test.</td></tr>
				</thead><tbody><tr>
<th colspan="3">1. login as user and try to drop database -> fail</th>
</tr>
<tr>
<th colspan="3">Login as janus</th>
</tr>
<tr>
<td>open</td>
<td>http://localhost:8800/ppa/intro.php</td>
<td></td>
</tr>
<tr>
<td>select</td>
<td>name=language</td>
<td>English</td>
</tr>
<tr>
<td>open</td>
<td>http://localhost:8800/ppa/login.php?server=localhost:5432:allow&subject=server</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>//input[@name='loginUsername']</td>
<td>ppa_tests_user</td>
</tr>
<tr>
<td>type</td>
<td>//input[@id='loginPassword']</td>
<td>ppa_tests_user_pass</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=loginSubmit</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//div[@class='topbar']/descendant::span[@class='username']</td>
<td>ppa_tests_user</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Databases</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='ppatests_db']/../../td/a[text()='Drop']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=drop</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Database drop failed.</td>
</tr>
<tr>
<th colspan="3">2. logout / login as admin_user and drop user role/user</th>
</tr>
<tr>
<th colspan="3">Logout</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>//div[@class='trail']/descendant::tr/td[1]/a/span[@class='label' and text()='phpPgAdmin']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Servers</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='PostgreSQL']/../../td/a[text()='Logout']</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Logged out of PostgreSQL</td>
</tr>
<tr>
<th colspan="3">Login as janus</th>
</tr>
<tr>
<td>open</td>
<td>http://localhost:8800/ppa/intro.php</td>
<td></td>
</tr>
<tr>
<td>select</td>
<td>name=language</td>
<td>English</td>
</tr>
<tr>
<td>open</td>
<td>http://localhost:8800/ppa/login.php?server=localhost:5432:allow&subject=server</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>//input[@name='loginUsername']</td>
<td>admin_user</td>
</tr>
<tr>
<td>type</td>
<td>//input[@id='loginPassword']</td>
<td>super</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=loginSubmit</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//div[@class='topbar']/descendant::span[@class='username']</td>
<td>admin_user</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Roles</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='ppa_tests_user']/../../td/a[text()='Drop']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=drop</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Role dropped.</td>
</tr>
<tr>
<th colspan="3">3. try to drop himself -> fail</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Roles</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=admin_user</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//div[@class='trail']/descendant::a[@title='Role']/span[@class='label']</td>
<td>admin_user</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Drop</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=drop</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Role drop failed.</td>
</tr>
<tr>
<th colspan="3">4. drop domain -> fail table promo depend on it</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Databases</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=ppatests_db</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Schemas</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=test_schema</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Domains</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='year']/../../td/a[text()='Drop']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=drop</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Domain drop failed.</td>
</tr>
<tr>
<th colspan="3">5. drop domain with cascade, test if promo.year disapeared</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>//div[@class='trail']/descendant::a[@title='Database']/span[@class='label' and text()='ppatests_db']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Schemas</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=test_schema</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Domains</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='year']/../../td/a[text()='Drop']</td>
<td></td>
</tr>
<tr>
<td>check</td>
<td>name=cascade</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=drop</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Domain dropped.</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//div[@class='trail']/descendant::a[@title='Schema']/span[@class='label' and text()='test_schema']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Tables</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=promo</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Columns</td>
<td></td>
</tr>
<tr>
<td>assertErrorOnNext</td>
<td>Element link=year not found</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=year</td>
<td></td>
</tr>
<tr>
<th colspan="3">6. drop table student with cascade using the action button</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>//div[@class='trail']/descendant::a[@title='Server']/span[@class='label' and text()='PostgreSQL']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Databases</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=ppatests_db</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Schemas</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=public</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='student']/../../td/a[text()='Drop']</td>
<td></td>
</tr>
<tr>
<td>check</td>
<td>name=cascade</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=drop</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Table dropped.</td>
</tr>
<tr>
<th colspan="3">7. drop table promo using the button from tblproperties</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>//div[@class='trail']/descendant::a[@title='Server']/span[@class='label' and text()='PostgreSQL']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Databases</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=ppatests_db</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Schemas</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=test_schema</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Tables</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=promo</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//ul[@class='navlink']/li/a[text()='Drop']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=drop</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Table dropped.</td>
</tr>
<tr>
<th colspan="3">8. drop test database</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>//div[@class='trail']/descendant::a[@title='Server']/span[@class='label' and text()='PostgreSQL']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Databases</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='ppatests_db']/../../td/a[text()='Drop']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=drop</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Database dropped.</td>
</tr>
<tr>
<th colspan="3">9. logout & login as superuser and drop admin_user</th>
</tr>
<tr>
<th colspan="3">Logout</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>//div[@class='trail']/descendant::tr/td[1]/a/span[@class='label' and text()='phpPgAdmin']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Servers</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='PostgreSQL']/../../td/a[text()='Logout']</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Logged out of PostgreSQL</td>
</tr>
<tr>
<th colspan="3">Login as janus</th>
</tr>
<tr>
<td>open</td>
<td>http://localhost:8800/ppa/intro.php</td>
<td></td>
</tr>
<tr>
<td>select</td>
<td>name=language</td>
<td>English</td>
</tr>
<tr>
<td>open</td>
<td>http://localhost:8800/ppa/login.php?server=localhost:5432:allow&subject=server</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>//input[@name='loginUsername']</td>
<td>janus</td>
</tr>
<tr>
<td>type</td>
<td>//input[@id='loginPassword']</td>
<td>secret</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=loginSubmit</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//div[@class='topbar']/descendant::span[@class='username']</td>
<td>janus</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Roles</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='admin_user']/../../td/a[text()='Drop']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=drop</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Role dropped.</td>
</tr>
<tr>
<th colspan="3">Logout</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>//div[@class='trail']/descendant::tr/td[1]/a/span[@class='label' and text()='phpPgAdmin']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Servers</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='PostgreSQL']/../../td/a[text()='Logout']</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Logged out of PostgreSQL</td>
</tr>
