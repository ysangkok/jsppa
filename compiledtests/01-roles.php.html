<html>
<head>
				<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
				<title>Roles, Users and Groups tests</title>
				</head>
				<body>
				<table cellpadding="1" cellspacing="1" border="1">
				<thead>
				<tr><td rowspan="1" colspan="3">Create test admin role, test user role and tests Roles (or user/groups) features.</td></tr>
				</thead><tbody><tr>
<th colspan="3">1. login as superuser</th>
</tr>
<tr>
<th colspan="3">Login as janus</th>
</tr>
<tr>
<td>open</td>
<td>http://localhost:8800/ppa/intro.php</td>
<td></td>
</tr>
<tr>
<td>select</td>
<td>name=language</td>
<td>English</td>
</tr>
<tr>
<td>open</td>
<td>http://localhost:8800/ppa/login.php?server=localhost:5432:allow&subject=server</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>//input[@name='loginUsername']</td>
<td>janus</td>
</tr>
<tr>
<td>type</td>
<td>//input[@id='loginPassword']</td>
<td>secret</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=loginSubmit</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//div[@class='topbar']/descendant::span[@class='username']</td>
<td>janus</td>
</tr>
<tr>
<th colspan="3">2. create admin_user role/user with wrong pass conf -> fail</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Roles</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Create role</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>name=formRolename</td>
<td>admin_user</td>
</tr>
<tr>
<td>click</td>
<td>name=formCreateRole</td>
<td></td>
</tr>
<tr>
<td>click</td>
<td>name=formInherits</td>
<td></td>
</tr>
<tr>
<td>click</td>
<td>name=formCanLogin</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>name=formPassword</td>
<td>superbad</td>
</tr>
<tr>
<td>type</td>
<td>name=formConfirm</td>
<td>super</td>
</tr>
<tr>
<td>click</td>
<td>name=formSuper</td>
<td></td>
</tr>
<tr>
<td>click</td>
<td>name=formCreateDB</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=create</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Password does not match confirmation.</td>
</tr>
<tr>
<th colspan="3">3. create admin_user</th>
</tr>
<tr>
<td>type</td>
<td>name=formPassword</td>
<td>super</td>
</tr>
<tr>
<td>type</td>
<td>name=formConfirm</td>
<td>super</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=create</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Role created.</td>
</tr>
<tr>
<th colspan="3">4. logout & login as admin_user</th>
</tr>
<tr>
<th colspan="3">Logout</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>//div[@class='trail']/descendant::tr/td[1]/a/span[@class='label' and text()='phpPgAdmin']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Servers</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='PostgreSQL']/../../td/a[text()='Logout']</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Logged out of PostgreSQL</td>
</tr>
<tr>
<th colspan="3">Login as janus</th>
</tr>
<tr>
<td>open</td>
<td>http://localhost:8800/ppa/intro.php</td>
<td></td>
</tr>
<tr>
<td>select</td>
<td>name=language</td>
<td>English</td>
</tr>
<tr>
<td>open</td>
<td>http://localhost:8800/ppa/login.php?server=localhost:5432:allow&subject=server</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>//input[@name='loginUsername']</td>
<td>admin_user</td>
</tr>
<tr>
<td>type</td>
<td>//input[@id='loginPassword']</td>
<td>super</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=loginSubmit</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//div[@class='topbar']/descendant::span[@class='username']</td>
<td>admin_user</td>
</tr>
<tr>
<th colspan="3">5. create user role/user with altered name, pass and props</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Roles</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Create role</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>name=formRolename</td>
<td>ppa_tests_usertoalter</td>
</tr>
<tr>
<td>check</td>
<td>name=formCanLogin</td>
<td></td>
</tr>
<tr>
<td>check</td>
<td>name=formCreateRole</td>
<td></td>
</tr>
<tr>
<td>check</td>
<td>name=formInherits</td>
<td></td>
</tr>
<tr>
<td>check</td>
<td>name=formSuper</td>
<td></td>
</tr>
<tr>
<td>check</td>
<td>name=formCreateDB</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>name=formPassword</td>
<td>ppa_tests_user_passtoalter</td>
</tr>
<tr>
<td>type</td>
<td>name=formConfirm</td>
<td>ppa_tests_user_passtoalter</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=create</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Role created.</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_usertoalter']</td>
<td>ppa_tests_usertoalter</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_usertoalter']/../../td[2]</td>
<td>Yes</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_usertoalter']/../../td[3]</td>
<td>Yes</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_usertoalter']/../../td[4]</td>
<td>Yes</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_usertoalter']/../../td[5]</td>
<td>Yes</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_usertoalter']/../../td[6]</td>
<td>Yes</td>
</tr>
<tr>
<th colspan="3">6. alter user back to the normal value</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Roles</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=ppa_tests_usertoalter</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Alter</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>name=formNewRoleName</td>
<td>ppa_tests_user</td>
</tr>
<tr>
<td>uncheck</td>
<td>name=formCreateRole</td>
<td></td>
</tr>
<tr>
<td>uncheck</td>
<td>name=formInherits</td>
<td></td>
</tr>
<tr>
<td>uncheck</td>
<td>name=formSuper</td>
<td></td>
</tr>
<tr>
<td>uncheck</td>
<td>name=formCreateDB</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>name=formPassword</td>
<td>ppa_tests_user_pass</td>
</tr>
<tr>
<td>type</td>
<td>name=formConfirm</td>
<td>ppa_tests_user_pass</td>
</tr>
<tr>
<td>clickAndWait</td>
<td>name=alter</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Role altered.</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_user']</td>
<td>ppa_tests_user</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_user']/../../td[2]</td>
<td>No</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_user']/../../td[3]</td>
<td>No</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_user']/../../td[4]</td>
<td>No</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_user']/../../td[5]</td>
<td>No</td>
</tr>
<tr>
<td>assertText</td>
<td>//tr/td/a[text()='ppa_tests_user']/../../td[6]</td>
<td>Yes</td>
</tr>
<tr>
<th colspan="3">Logout</th>
</tr>
<tr>
<td>clickAndWait</td>
<td>//div[@class='trail']/descendant::tr/td[1]/a/span[@class='label' and text()='phpPgAdmin']</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>link=Servers</td>
<td></td>
</tr>
<tr>
<td>clickAndWait</td>
<td>//tr/td/a[text()='PostgreSQL']/../../td/a[text()='Logout']</td>
<td></td>
</tr>
<tr>
<td>assertText</td>
<td>//p[@class='message']</td>
<td>Logged out of PostgreSQL</td>
</tr>
